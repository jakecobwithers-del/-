<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flower Collective</title>

  <!-- Styles -->
  <style>
    :root{
      --accent:#e6a0c7;
      --accent-2:#d14b8b;
      --muted:rgba(255,255,255,0.85);
      --glass:rgba(0,0,0,0.45);
      --blur:10px;
      --max-width:1100px;
      --radius:12px;
      font-family: Inter, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
    }

    html,body{
      height:100%;
      margin:0;
      color:var(--muted);
      background:#000;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* full-screen background video */
    #bg-video{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index:0;
      filter:brightness(0.6) saturate(1.05);
    }

    /* subtle overlay gradient to match luxe lab palette */
    .video-tint{
      position:fixed;
      inset:0;
      background:linear-gradient(180deg, rgba(16,12,20,0.25), rgba(8,6,10,0.6));
      z-index:1;
      pointer-events:none;
    }

    /* page container */
    .wrap{
      position:relative;
      z-index:2;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 24px;
      box-sizing:border-box;
    }

    .card{
      width:100%;
      max-width:900px;
      display:flex;
      gap:32px;
      align-items:center;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:var(--radius);
      padding:28px;
      box-shadow:0 10px 40px rgba(2,2,2,0.6);
      backdrop-filter: blur(var(--blur));
      border:1px solid rgba(255,255,255,0.04);
    }

    /* left column with branding */
    .brand{
      flex:1 1 360px;
      min-width:260px;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:flex-start;
    }

    .logo{
      width:110px;
      height:110px;
      object-fit:contain;
      border-radius:16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.6), inset 0 -6px 18px rgba(0,0,0,0.25);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
      padding:10px;
    }

    h1{
      margin:0;
      font-size:28px;
      line-height:1.02;
      color:#fff;
      letter-spacing:-0.02em;
    }

    p.lead{
      margin:0;
      color:var(--muted);
      opacity:0.95;
      max-width:36ch;
    }

    /* right column with shop form and items */
    .shop{
      width:420px;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:stretch;
    }

    .items{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }

    .item{
      display:flex;
      gap:12px;
      align-items:center;
      padding:10px;
      background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.03));
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .item .meta{
      flex:1;
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .item .title{
      font-weight:600;
      color:#fff;
    }

    .item .price{
      font-size:13px;
      color:var(--accent);
    }

    .qty{
      width:72px;
      display:flex;
      gap:6px;
      align-items:center;
    }

    .qty input[type="number"]{
      width:46px;
      padding:6px 8px;
      border-radius:8px;
      border:none;
      background:rgba(255,255,255,0.03);
      color:var(--muted);
      text-align:center;
    }

    form#cart-form{
      margin-top:6px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }

    input[type="email"]{
      flex:1;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.04);
      background:rgba(255,255,255,0.02);
      color:var(--muted);
      outline:none;
    }

    .actions{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .btn{
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:600;
      letter-spacing:0.01em;
    }

    .btn-paypal{
      background:linear-gradient(180deg, #0070ba, #005ea6);
      color:#fff;
      box-shadow:0 6px 18px rgba(0,0,0,0.45);
    }

    .btn-cart{
      background:linear-gradient(180deg, var(--accent), var(--accent-2));
      color:#111;
    }

    .note{
      font-size:13px;
      color:rgba(255,255,255,0.7);
      margin-top:6px;
    }

    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:28px;
      background:rgba(0,0,0,0.7);
      color:#fff;
      padding:10px 16px;
      border-radius:10px;
      box-shadow:0 8px 30px rgba(0,0,0,0.5);
      display:none;
      z-index:6;
    }

    /* responsive */
    @media (max-width:920px){
      .card{flex-direction:column;align-items:stretch;}
      .shop{width:100%;}
    }
  </style>
</head>
<body>
  <!-- Background video -->
  <video id="bg-video" autoplay muted loop playsinline>
    <source src="flower.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>
  <div class="video-tint"></div>

  <!-- Main content -->
  <div class="wrap">
    <div class="card" role="region" aria-label="Shop">
      <div class="brand">
        <img src="flower.png" alt="Flower logo" class="logo" />
        <h1>Flower Collective</h1>
        <p class="lead">Cinematic, curated pieces inspired by natural textures and luxe palettes. Quick local dispatch and secure PayPal checkout.</p>
        <p class="note">Colours, spacing, and type follow a soft luxe palette similar to the shop you referenced for a moody, cinematic look.</p>
      </div>

      <div class="shop" aria-live="polite">
        <!-- Items list -->
        <div class="items" id="items">
          <!-- Example item. Duplicate and edit to add more products -->
          <div class="item" data-id="sku-flower-01" data-title="Petal Necklace" data-price="59.00">
            <div class="meta">
              <div class="title">Petal Necklace</div>
              <div class="price">$59.00 AUD</div>
            </div>
            <div class="qty" aria-hidden="true">
              <label style="display:none">Qty</label>
              <input type="number" value="1" min="1" class="item-qty" />
            </div>
          </div>

          <div class="item" data-id="sku-flower-02" data-title="Pressed Flower Pin" data-price="25.00">
            <div class="meta">
              <div class="title">Pressed Flower Pin</div>
              <div class="price">$25.00 AUD</div>
            </div>
            <div class="qty" aria-hidden="true">
              <input type="number" value="1" min="1" class="item-qty" />
            </div>
          </div>
        </div>

        <!-- Checkout form -->
        <form id="cart-form" novalidate>
          <input type="email" id="buyer-email" name="buyerEmail" placeholder="Your email address" required aria-label="Your email" />
          <div class="actions">
            <button type="button" id="add-to-cart" class="btn btn-cart">Prepare Order</button>
            <a id="paypal-link" class="btn btn-paypal" href="#" target="_blank" rel="noopener">Pay with PayPal</a>
          </div>
        </form>

        <p class="note" id="order-note">Prepare your order then press Pay with PayPal to complete payment. After payment you will receive an email and I will be notified of the purchase.</p>
      </div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- Scripts -->
  <script>
    /*
      Client side shop flow
      - Prepares an order summary from visible items and quantities
      - Opens PayPal.me in a new tab with the total amount
      - Sends an order email to Jakecob.withers@icloud.com using EmailJS
      - Replace the EMAILJS placeholders with your EmailJS user/service/template ids
      - Replace PAYPAL_ME_USERNAME with your PayPal.me username
    */

    // Configuration - edit these values
    const RECEIVER_EMAIL = "Jakecob.withers@icloud.com";
    const PAYPAL_ME_USERNAME = "YOUR_PAYPAL_ME_USERNAME"; // replace with your PayPal.me id, e.g. 'jake-withers'
    const CURRENCY = "AUD";

    // EmailJS configuration placeholders
    const EMAILJS_USER = "YOUR_EMAILJS_USER_ID";
    const EMAILJS_SERVICE = "YOUR_EMAILJS_SERVICE_ID";
    const EMAILJS_TEMPLATE = "YOUR_EMAILJS_TEMPLATE_ID";

    // Toast utility
    const toast = document.getElementById('toast');
    function showToast(msg, timeout = 4000){
      toast.textContent = msg;
      toast.style.display = 'block';
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> toast.style.display = 'none', timeout);
    }

    // Build order summary from DOM items
    function buildOrder(){
      const items = Array.from(document.querySelectorAll('.item'));
      const order = [];
      let total = 0;
      items.forEach(node=>{
        const id = node.dataset.id;
        const title = node.dataset.title;
        const price = parseFloat(node.dataset.price);
        const qtyEl = node.querySelector('.item-qty');
        const qty = qtyEl ? Math.max(1, parseInt(qtyEl.value||1,10)) : 1;
        const lineTotal = Math.round((price * qty + Number.EPSILON) * 100) / 100;
        if(qty > 0){
          order.push({id,title,price:price.toFixed(2),qty,lineTotal:lineTotal.toFixed(2)});
          total += lineTotal;
        }
      });
      total = Math.round((total + Number.EPSILON) * 100) / 100;
      return {order,total:total.toFixed(2),currency:CURRENCY};
    }

    // Update PayPal link to open PayPal.me with the correct amount
    function updatePayPalLink(amount){
      // PayPal.me URL takes amount in the path: https://paypal.me/username/12.34
      const href = `https://paypal.me/${encodeURIComponent(PAYPAL_ME_USERNAME)}/${encodeURIComponent(amount)}`;
      const link = document.getElementById('paypal-link');
      link.href = href;
    }

    // Send order via EmailJS
    function sendOrderEmail(orderSummary, buyerEmail){
      // EmailJS is used purely client-side here. To use:
      // 1. Sign up at https://www.emailjs.com
      // 2. Create service and template, then copy user id, service id, template id below.
      // 3. Template should accept variables used in 'templateParams'
      if(!window.emailjs){
        showToast('Email service not configured. Add EmailJS script and IDs.');
        return Promise.reject('emailjs-missing');
      }

      const templateParams = {
        to_email: RECEIVER_EMAIL,
        buyer_email: buyerEmail,
        order_json: JSON.stringify(orderSummary.order, null, 2),
        order_total: orderSummary.total,
        currency: orderSummary.currency,
        shop_name: "Flower Collective"
      };

      return emailjs.send(EMAILJS_SERVICE, EMAILJS_TEMPLATE, templateParams)
        .then(function(response) {
          showToast('Order email sent to shop owner.');
          return response;
        }, function(error) {
          showToast('Failed to send order email.');
          console.error('EmailJS error', error);
          throw error;
        });
    }

    // Attach handlers
    document.getElementById('add-to-cart').addEventListener('click', function(){
      const buyerEmail = document.getElementById('buyer-email').value.trim();
      if(!buyerEmail || !/^\S+@\S+\.\S+$/.test(buyerEmail)){
        showToast('Please enter a valid email address.');
        return;
      }

      const summary = buildOrder();
      if(summary.order.length === 0){
        showToast('No items selected.');
        return;
      }

      // Update PayPal link to reflect amount
      updatePayPalLink(summary.total);

      // Send email to shop owner with order details
      // Attempt to send via EmailJS; if not configured, fall back to opening mailto for manual copy
      if(EMAILJS_USER && EMAILJS_SERVICE && EMAILJS_TEMPLATE){
        // initialize EmailJS if not already
        if(window.emailjs && !emailjs._inited){
          emailjs.init(EMAILJS_USER);
          emailjs._inited = true;
        }

        sendOrderEmail(summary, buyerEmail).catch(()=>{
          // fallback mailto link in case email service fails
          const subject = encodeURIComponent(`New order from ${buyerEmail} - $${summary.total} ${summary.currency}`);
          const body = encodeURIComponent(`Order total: $${summary.total} ${summary.currency}\n\nItems:\n${summary.order.map(i=>`${i.qty} × ${i.title} — $${i.lineTotal}`).join('\n')}\n\nBuyers email: ${buyerEmail}`);
          window.location.href = `mailto:${RECEIVER_EMAIL}?subject=${subject}&body=${body}`;
        });
      } else {
        // If EmailJS not configured, open user's mail client with prefilled content to notify you
        const subject = encodeURIComponent(`New order from ${buyerEmail} - $${summary.total} ${summary.currency}`);
        const body = encodeURIComponent(`Order total: $${summary.total} ${summary.currency}\n\nItems:\n${summary.order.map(i=>`${i.qty} × ${i.title} — $${i.lineTotal}`).join('\n')}\n\nBuyers email: ${buyerEmail}`);
        window.location.href = `mailto:${RECEIVER_EMAIL}?subject=${subject}&body=${body}`;
        showToast('Opened mail client to notify owner. Configure EmailJS for automatic emails.');
      }

      showToast('Order prepared. Click Pay with PayPal to complete payment.');
    });

    // Initialize UI with default PayPal link
    updatePayPalLink('0.00');

    // Optional: load EmailJS script if you intend to use it
    (function loadEmailJSScript(){
      if(!EMAILJS_USER || !EMAILJS_SERVICE || !EMAILJS_TEMPLATE) return;
      if(window.emailjs) return;
      const s = document.createElement('script');
      s.src = 'https://cdn.emailjs.com/dist/email.min.js';
      s.onload = function(){
        if(window.emailjs && EMAILJS_USER) {
          emailjs.init(EMAILJS_USER);
          emailjs._inited = true;
        }
      };
      s.onerror = function(){ console.warn('EmailJS script failed to load'); };
      document.head.appendChild(s);
    })();
  </script>
</body>
</html>